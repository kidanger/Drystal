include_rules

ifdef EMSCRIPTEN
tt=extensions/truetype/@(EXTENSION_FILE)
web=extensions/web/@(EXTENSION_FILE)
net=extensions/net/@(EXTENSION_FILE)
physic=extensions/physic/@(EXTENSION_FILE)
particle=extensions/particle/@(EXTENSION_FILE)
storage=extensions/storage/@(EXTENSION_FILE)
ifdef FAST_LINK
: src/*.o |> !ld_drystal |> drystal_nolua.js
: drystal_nolua.js external/liblua.js |> @(EMLINK) %f %o |> drystal.js
: drystal.js $(tt) |> @(EMLINK) %f %o |> drystal_truetype.js
: drystal_truetype.js $(web) |> @(EMLINK) %f %o |> drystal_truetype_web.js
: drystal_truetype_web.js $(net) |> @(EMLINK) %f %o |> drystal_truetype_web_net.js
: drystal_truetype_web_net.js $(physic) |> @(EMLINK) %f %o |> drystal_truetype_web_net_physic.js
: drystal_truetype_web_net_physic.js $(physic) |> @(EMLINK) %f %o |> drystal_truetype_web_net_physic_particle.js
: drystal_truetype_web_net_physic_particle.js $(storage) |> @(EMLINK) %f %o |> drystal_truetype_web_net_physic_particle_storage.js
: drystal_truetype_web_net_physic_particle_storage.js |> cp %f %o |> index_nodata.js
else
EXTENSIONS=$(tt) $(web) $(net) $(physic) $(particle) $(storage)
: src/*.o $(EXTENSIONS) | external/liblua-drystal.so ../external/<lua> |> !ld_drystal |> index_nodata.js
endif

else
: src/*.o | external/liblua-drystal.so ../external/<lua> |> !ld_drystal |> drystal
endif

